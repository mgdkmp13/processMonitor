<Window x:Class="processMonitor.Views.MonitoredProcessesWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Monitored Processes" Height="500" Width="800">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisConverter"/>
    </Window.Resources>
    
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <TextBlock Grid.Row="0" Text="Tracked Processes" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>
        
        <ListView Grid.Row="1" ItemsSource="{Binding MonitoredProcesses}">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="PID" DisplayMemberBinding="{Binding ProcessId, Mode=OneWay}" Width="60"/>
                    <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name, Mode=OneWay}" Width="150"/>
                    <GridViewColumn Header="Started At" DisplayMemberBinding="{Binding StartedAt, StringFormat='{}{0:yyyy-MM-dd HH:mm:ss}', Mode=OneWay}" Width="150"/>
                    <GridViewColumn Header="Finished At" DisplayMemberBinding="{Binding FinishedAt, StringFormat='{}{0:yyyy-MM-dd HH:mm:ss}', Mode=OneWay}" Width="150"/>
                    <GridViewColumn Header="Duration" DisplayMemberBinding="{Binding TrackingDuration, Mode=OneWay}" Width="120"/>
                    <GridViewColumn Header="Samples" DisplayMemberBinding="{Binding MemorySamples.Count, Mode=OneWay}" Width="80"/>
                    <GridViewColumn Header="Avg Memory (MB)" Width="120">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding AverageMemory, StringFormat=N2, Mode=OneWay}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
            
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="ToolTip">
                        <Setter.Value>
                            <StackPanel>
                                <TextBlock FontWeight="Bold" Margin="0,0,0,5">
                                    <Run Text="Process: "/>
                                    <Run Text="{Binding Name, Mode=OneWay}"/>
                                    <Run Text=" (PID: "/>
                                    <Run Text="{Binding ProcessId, Mode=OneWay}"/>
                                    <Run Text=")"/>
                                </TextBlock>
                                <TextBlock>
                                    <Run Text="Tracking Duration: "/>
                                    <Run Text="{Binding TrackingDuration, Mode=OneWay}"/>
                                </TextBlock>
                                <TextBlock>
                                    <Run Text="Memory Samples: "/>
                                    <Run Text="{Binding MemorySamples.Count, Mode=OneWay}"/>
                                </TextBlock>
                                <TextBlock>
                                    <Run Text="Average Memory: "/>
                                    <Run Text="{Binding AverageMemory, StringFormat=N2, Mode=OneWay}"/>
                                    <Run Text=" MB"/>
                                </TextBlock>
                            </StackPanel>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding FinishedAt, Mode=OneWay}" Value="{x:Null}">
                            <Setter Property="Background" Value="LightGreen"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </ListView.ItemContainerStyle>
        </ListView>
    </Grid>
</Window>
